---
title: "Основы обработки данных с помощью R и Dplyr"
subtitle: "lab2"
author: "gleb.plokhikh@yandex.ru"
format: 
  md:
    output-file: README.md
---

## Цель работы

1. Развить практические навыки использования языка программирования R для обработки данных
2. Закрепить знания базовых типов данных языка R
3. Развить практические навыки использования функций обработки данных пакета dplyr – функции select(), filter(), mutate(), arrange(), group_by()

## Исходные данные

1. Rstudio Desktop;
2. Интерпретатор языка R 4.1;
3. Программный пакет `dplyr` и `knitr`.
 
## План

Проанализировать встроенный в пакет dplyr набор данных starwars с помощью языка R и ответить на вопросы.   

## Решение:   

1\. Сколько строк в датафрейме?

```{r}
library(dplyr)
library(knitr)
data("starwars")
starwars |> nrow()
```

2\. Размер датафрейма?

```{r}
data.frame(
  rows = nrow(starwars),
  cols = ncol(starwars)
) |> knitr::kable()
```

3\. Как просмотреть примерный вид датафрейма?

```{r}
glimpse(starwars)
```

4\. Сколько уникальных рас персонажей (species) представлено в данных?

```{r}
starwars |> distinct(species) |> count() |> knitr::kable()
```

5\. Найти самого высокого персонажа.

```{r}
starwars |>
filter(height > 170) |>
select(name, height) |>
knitr::kable()
```

6\. Найти всех персонажей ниже 170.

```{r}
starwars |>
filter(height < 170) |>
select(name, height) |>
knitr::kable()
```

7\. Подсчитать ИМТ (индекс массы тела) для всех персонажей. 

```{r}
starwars |>
mutate(BMI = mass / ((height / 100)^2)) |>
select(name, height, mass, BMI) |>
knitr::kable()
```

8\. Найти 10 самых “вытянутых” персонажей. “Вытянутость” оценить по отношению массы (mass) к росту (height) персонажей.

```{r}
starwars |>
mutate(mass_to_height = mass / height) |>
arrange(desc(mass_to_height)) |>
select(name, height, mass, mass_to_height) |>
slice_head(n = 10) |>
knitr::kable()
```

9\. Найти средний возраст персонажей каждой расы вселенной Звездных войн.

```{r}
starwars |>
group_by(species) |>
summarise(median_age = median(100 + birth_year, na.rm = TRUE)) |>
knitr::kable()
```

10\. Найти самый распространенный цвет глаз персонажей вселенной Звездных войн.

```{r}
starwars |>
count(eye_color, sort = TRUE) |>
slice_head(n = 1) |>
knitr::kable()
```

11\. Подсчитать среднюю длину имени в каждой расе вселенной Звездных войн.

```{r}
starwars |>
group_by(species) |>
summarise(avg_name_length = mean(nchar(name), na.rm = TRUE)) |>
knitr::kable()
```

## Оценка результата

 В результате лабораторной работы мы проанализировали встроенный в пакет dplyr набор данных starwars с помощью языка R.

## Вывод

Таким образом, мы развили практические навыки использования языка программирования R для обработки данных, закрепили знания базовых типов данных языка R, развили практические навыки использования функций обработки данных пакета dplyr – функции select(), filter(), mutate(), arrange(), group_by().
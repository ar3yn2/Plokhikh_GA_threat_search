---
title: "3ПР Основы обработки данных с помощью R и Dplyr"
subtitle: "lab3"
author: "gleb.plokhikh@yandex.ru"
format: 
  md:
    output-file: README.md
---

## Цель работы

1. Развить практические навыки использования языка программирования R для обработки данных
2. Закрепить знания базовых типов данных языка R
3. Развить практические навыки использования функций обработки данных пакета dplyr – функции select(), filter(), mutate(), arrange(), group_by()

## Исходные данные

1. Rstudio Desktop;
2. Интерпретатор языка R 4.1;
3. Программный пакет `dplyr` и `knitr`.
 
## План

Проанализировать встроенный в пакет dplyr набор данных `nycflights13` с помощью языка R и ответить на вопросы.   

## Решение:   

1\. Загрузка библиотек

```{r}
library(dplyr)
library(knitr)
library(nycflights13)
```

2\. Сколько встроенных в пакет `nycflights13` датафреймов?

```{r}
data(package = "nycflights13")$results[, "Item"]
```

3\. Сколько строк и столбцов в каждом датафрейме?

```{r}
tibble(
dataset = c("airlines", "airports", "flights", "planes", "weather"),
rows = c(nrow(airlines), nrow(airports), nrow(flights), nrow(planes), nrow(weather)),
cols = c(ncol(airlines), ncol(airports), ncol(flights), ncol(planes), ncol(weather))
) |> knitr::kable()
```

4\. Просмотр структуры данных

```{r}
glimpse(flights)
glimpse(weather)
```

5\. Сколько компаний-перевозчиков (carrier) учитывают эти наборы данных (представлено в наборах данных)?

```{r}
airlines |> distinct(carrier) |> count() |> knitr::kable()
```

6\. Сколько рейсов принял аэропорт John F Kennedy Intl в мае?

```{r}
flights |>
filter(origin == "JFK", month == 5) |>
summarise(total_flights = n()) |>
knitr::kable()
```

7\. Какой самый северный аэропорт?

```{r}
airports |>
slice_max(lat, n = 1) |>
select(name, lat) |>
knitr::kable()
```
8\. Аэропорт с наибольшей высотой над уровнем моря

```{r}
airports |>
slice_max(alt, n = 1) |>
select(name, alt) |>
knitr::kable()
```
9\. Какие бортовые номера у самых старых самолетов?

```{r}
planes |>
filter(!is.na(year)) |>
arrange(year) |>
select(tailnum, year) |>
slice_head(n = 10) |>
knitr::kable()
```

10\. Какая средняя температура воздуха была в сентябре в аэропорту John F Kennedy Intl (в градусах Цельсия).

```{r}
weather %>% filter(origin=='JFK', month==9) %>% summarize(mean_temp = (mean(temp, na.rm = TRUE)-32)*5/9) |> knitr::kable(format='markdown')
```

11\. Авиакомпания с наибольшим числом вылетов в июне

```{r}
flights |>
filter(month == 6) |>
count(carrier, sort = TRUE) |>
left_join(airlines, by = "carrier") |>
slice(1) |>
select(name, n) |>
knitr::kable()
```

12\. Авиакомпания с наибольшим числом задержек в 2013 году
```{r}
flights |>
filter(year == 2013, arr_delay > 0) |>
count(carrier, sort = TRUE) |>
left_join(airlines, by = "carrier") |>
slice(1) |>
select(name, n) |>
knitr::kable()
```

## Оценка результата

 В результате лабораторной работы мы проанализировали встроенный в пакет dplyr набор данных `nycflights13` с помощью языка R.

## Вывод

Таким образом, мы развили практические навыки использования языка программирования R для обработки данных, развили практические навыки использования функций обработки данных пакета dplyr – функции select(), filter(), mutate(), arrange(), group_by().
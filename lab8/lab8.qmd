---
title: "Использование технологии Yandex DataLens для анализа данных сет. активности"
author: "gleb.plokhikh@yandex.ru"
format: 
  md:
    output-file: README.md
---

## Цель работы

1. Изучить возможности технологии `Yandex DataLens` для визуального анализаструктурированных наборов данных
2. Получить навыки визуализации данных для последующего анализа с помощьюсервисов `Yandex Cloud`
3. Получить навыки создания решений мониторинга/SIEM на базе облачных продуктов и открытых программных решений
4. Закрепить практические навыки использования SQL для анализа данных сетевойактивности в сегментированной корпоративной сети

## Задачи

1. Представить в виде круговой диаграммы соотношение внешнего и внутреннего
сетевого трафика.
2. Представить в виде столбчатой диаграммы соотношение входящего и
исходящего трафика из внутреннего сетвого сегмента.
3. Построить график активности (линейная диаграмма) объема трафика во
времени.
4. Все построенные графики вывести в виде единого дашборда в `Yandex DataLens`.

## Исходные данные

1. Программное обеспечение Windows 11
2. Rstudio Desktop
3. Данные сетевой активности в корпоративной сети компании XYZ, хранящиеся в `Yandex Object Storage`
4. Сервисы `Yandex Cloud`

## Задание

  Используя сервис `Yandex DataLens` настроить доступ к `Yandex Query`, который мы использовали в ходе ранее выполненных практических работ, и визуально представить результаты анализа данных.

## Ход работы

1. Настроить подключение к `Yandex Query` из `DataLens`
2. Создать из запроса `YandexQuery` датасет `DataLens`
3. Сделать нужные графики и диаграммы
4. Составить дашборд
5. Оформление отчета

## Шаги

### 1. Настроить подключение к Yandex Query из DataLens

#### 1.1. Перейти в соответствующий сервиc

![](img/img1.png)


#### 1.2. Выбрать “Подключения” – “Создать новое подключение”

![](img/img2.png)

#### 1.3-1.4. Выбрать в разделе “Файлы и сервисы” Yandex Query, настроить и проверить подключение

![](img/img3.png)

### 2. Создать из запроса YandexQuery датасет DataLens

![](img/img4.png)

### 3. Сделать три чарта

Пример пустого чарта:

![](img/img5.png)

С нашим датасетом:

![](img/img6.png)

#### 3.1. Представить в виде круговой диаграммы соотношение внешнего и внутреннего сетевого трафика.

Для этого создадим вычисляемое поле, назовем его `int/ext`, поле будет представлять разделение сетевого трафика на внутренний и внешний. SQL-запрос представлен на рисунке:

![](img/img7.png)

В качестве показателя и подписи выберем поле `bytes`, итоговая круговая диаграмма:

![](img/img8.png)

#### 3.2. Представить в виде столбчатой диаграммы соотношение входящего и исходящего трафика из внутреннего сетевого сегмента.

Создадим поле `int/ext`, но для столбчатой диаграммы:


![](img/img9.png)

По Оси X разместим поле `int/ext`, по оси Y `bytes`, в качестве Цвета укажем `int/ext`, а в качестве подписи `bytes`:

![](img/img10.png)

#### 3.3. Построить график активности (линейная диаграмма) объема трафика во времени.

Из-за того, что изменение времени происходит на уровне миллисекунд, то придется преобразовать поле, отвечающее за него. Используем следующее преобразование времени:

![](img/img11.png)

За ось x возьмем нашу новую переменную edited_time, а за y возьмем sum([bytes]). 

![](img/img12.png)

### 4. Составляем дашборд

Итоговый дашборд:

![](img/img13.png)

[Ссылка на итоговый дашборд](https://datalens.ru/dxh7j71nkrmex)

## Вывод

  Таким образом используя сервис `Yandex DataLens` мы настроили доступ к `Yandex Query`, который мы использовали в ходе ранее выполненных практических работ, и визуально представили результаты анализа данных.